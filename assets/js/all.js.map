{"version":3,"sources":["addTodos.js","all.js","signup.js"],"names":["user","document","querySelector","header_logout","window","onload","init_token_render","sessionStorage","getItem","user_name","innerHTML","logoutBtn","addEventListener","e","preventDefault","axios","apiUrl","then","res","Swal","fire","data","message","result","isConfirmed","location","assign","err","console","log","response","loginInput","querySelectorAll","login_btn","loginEmail","loginPassword","login_alert_txt","login_status_txt","loginModal","bootstrap","Modal","value","trim","login_check_ok","loginCheck","input","login","textContent","post","mail","pwd","defaults","headers","common","authorization","setItem","nickname","setTimeout","show","loginReset","href","isnull","item","match","signUpInput","signUpBtn","signUpEmail","signUpNickname","signUpPassword","signUpPassword2","signup_alert_txt","signup_status_txt","signupModal","format_isOk","signupCheck","signup","signupReset","error","length"],"mappings":"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","file":"all.js","sourcesContent":["const user = document.querySelector('.username');\nconst header_logout = document.querySelector('.header_logout');\n\n\n// init start\n\n// 檢查有無token，若無token 不顯示登入後畫面\n\n  window.onload = function () {\n    init_token_render();\n\n    function init_token_render() {\n      if (sessionStorage.getItem('token')) {\n        const user_name = sessionStorage.getItem('name')\n        header_logout.innerHTML = `\n    <span class=\"d-none d-lg-block me-7 username\">${user_name}的代辦事項</span>\n    <a href=\"#\" class=\"text-dark fs-7 fs-lg-6 logoutBtn\">登出</a>\n    `\n      } else {\n        return;\n      }\n    }\n  }\n\n// 登出\nconst logoutBtn = document.querySelector('.logoutBtn');\nif (logoutBtn) {\n  logoutBtn.addEventListener('click', function (e) {\n    e.preventDefault();\n    axios.delete(`${apiUrl}/users/sign_out`\n    )\n  })\n  .then((res) => {\n    Swal.fire(\n      `${res.data.message}`,\n      \"已登出!\",\n      \"success\"\n    ).then((result) => {\n      if(result.isConfirmed){\n        window.location.assign(\"index.html\");\n      }\n    })\n    .catch((err) => console.log(err.response));\n  })\n}","\nconst apiUrl = 'https://todoo.5xcamp.us';\n//login-------------------------------------\nconst loginInput = document.querySelectorAll('.login-input');\nconst login_btn = document.querySelector('#login_btn');\nconst loginEmail = document.querySelector('#login-email');\nconst loginPassword = document.querySelector('#login-password');\nconst login_alert_txt = document.querySelector('.login_alert_txt');  //在 loginModal 上\nconst login_status_txt = document.querySelector('.login_status_txt');\nconst loginModal = new bootstrap.Modal('.js-login-modal');\n\n\n//login 設定------------------------------\nif (login_btn) {\n  login_btn.addEventListener('click', function (e) {\n    if (loginEmail.value.trim() == '' || loginPassword.value.trim() == '') {\n      return;\n    }\n  })\n  login_btn.addEventListener('click', () => {\n    const login_check_ok = loginCheck();\n    if (login_check_ok === true) {\n      input(loginEmail.value, loginPassword.value)\n    } else {\n      return;\n    }\n  })\n}\n//-------------------------以上為之前發出錯誤時少寫的程式碼\n\nfunction login(loginEmail, loginPassword) {\n  login_status_txt.textContent = '登入中請稍後 ...';\n  return axios.post(`${apiUrl}/users/sign_in`,\n    {\n      \"user\":{\n        \"email\": loginEmail,\n        \"password\": loginPassword\n      }\n    }\n  )\n}\n\nconst input = async(mail, pwd) => {\n  try{\n    const res = await login(mail, pwd);\n    //設置默認標頭的機制語法，該標頭將隨您發出的每個請求一起發送\n    axios.defaults.headers.common['Authorization'] = res.headers.authorization\n    sessionStorage.setItem('token', res.headers.authorization)\n    sessionStorage.setItem('name', res.data.nickname)\n    setTimeout(() =>{\n      login_status_txt.textContent = '';\n      login_alert_txt.innerHTML = `登入成功 ! 歡迎${res.data.nickname} 回來 <br><br> 即將跳轉待辦清單...`;\n      loginModal.show();\n      loginReset();\n      setTimeout(() =>{\n        document.location.href='./addTodos.html';\n      }, 2000);\n    }, 1000);\n  }\n  catch(error){\n    setTimeout(() =>{\n      login_status_txt.textContent = '';\n      login_alert_txt.textContent = '登入失敗，您的Email或密碼有誤!'\n      loginModal.show()\n      loginReset();\n    }, 1000);\n  }\n}\n\nfunction loginCheck(){\n  let isnull = false;\n  for(const item of loginInput){\n    if(item.value === ''){\n      isnull = true;\n      break;\n    }\n  }\n  if (isnull === true){\n    login_alert_txt.textContent = '您還有欄位尚未填寫喔!!';\n    loginModal.show();\n    loginReset();\n    return;\n  }\n  //email的輸入值字串必須有 @\n  if(loginEmail.value.match('@') === null){\n    login_alert_txt.textContent = '您的Email格式不正確!!!';\n    loginModal.show();\n    loginReset();\n    return;\n  }\n  return true;\n}\n\nfunction loginReset(){\n  loginEmail.value = '';\n  loginPassword.value = '';\n}\n","//signup---------------------------------------\nconst signUpInput = document.querySelectorAll('.signUpInput')\nconst signUpBtn = document.querySelector('.signup_btn');\nconst signUpEmail = document.querySelector('#signUpEmail');\nconst signUpNickname = document.querySelector('#signUpNickname');\nconst signUpPassword = document.querySelector('#signUpPassword');\nconst signUpPassword2 = document.querySelector('#signUpPassword2');\nconst signup_alert_txt = document.querySelector('.signup_alert_txt');\nconst signup_status_txt = document.querySelector('.signup_status_txt');\nconst signupModal = new bootstrap.Modal('.js-signup-modal');\n//-----------------------------------\n\nif (signUpBtn) {\n  signUpBtn.addEventListener('click', function (e) {\n    if (\n      signUpEmail.value.trim() == '' ||\n      signUpPassword.value.trim() == '' ||\n      signUpPassword2.value.trim() == '' ||\n      signUpNickname.value.trim() == ''\n    ) {\n      return;\n    }\n  })\n  signUpBtn.addEventListener('click', () => {\n    const format_isOk = signupCheck();\n    if (format_isOk === true) {\n      signup(signUpEmail, signUpNickname, signUpPassword)\n    } else {\n      return;\n    }\n  })\n}\n\nfunction signup(signUpEmail, signUpNickname, signUpPassword) {\n  signup_status_txt.textContent = `註冊中請稍後 ... `;\n  return axios.post(`${apiUrl}/users`, \n  {\n    \"user\": {\n      \"email\": signUpEmail.value,\n      \"nickname\": signUpNickname.value,\n      \"password\": signUpPassword.value\n    }\n  })\n    .then(res => {\n      setTimeout(() => {\n        signup_alert_txt.innerHTML = `註冊成功 ! 歡迎${res.data.nickname}光臨本網站 <br><br> 頁面即將在3秒後跳轉至登入畫面 ...`;\n        signupModal.show();\n        signupReset();\n        setTimeout(() => {\n          document.location.href = './index.html'\n        }, 2000)\n      }, 1000)\n    })\n    .catch(error => {\n      console.log(error.response);\n      setTimeout(() => {\n        signup_alert_txt.innerHTML = `很抱歉 ! 您的${error.response.data.error[0]} 請重新註冊`;\n        signupModal.show();\n        signup_status_txt.textContent = '';\n        signupReset();\n      }, 1000);\n    })\n}\n\nfunction signupCheck() {\n  let isnull = false;\n\n  for (const item of signUpInput) {\n    if (item.value == '') {\n      isnull = true;\n      break;\n    }\n  }\n  if (isnull === true) {\n    signup_alert_txt.textContent = '您還有欄位尚未填寫';\n    signupModal.show();\n    return;\n  }\n  if (signUpEmail.value.match('@') === null) {\n    signup_alert_txt.textContent = 'Email 格式不正確';\n    signupModal.show();\n    signupReset();\n    return;\n  }\n  if (signUpPassword.value.trim().length < 6) {\n    signup_alert_txt.textContent = '密碼必須6個字以上喔 ! ';\n    signupModal.show();\n    signupReset();\n    // 為何以下這兩個程式碼不能用 signupReset(); 去取代 \n    // signUpPassword.value = '';\n    // signUpPassword2.value = '';\n    return;\n  }\n  if (signUpPassword.value !== signUpPassword2.value) {\n    signup_alert_txt.textContent = '兩次的密碼輸入不一致喔 ! ';\n    signupModal.show();\n    signupReset();\n    // 為何以下這兩個程式碼不能用 signupReset(); 去取代 \n    // signUpPassword.value = '';\n    // signUpPassword2.value = '';\n    return;\n  }\n  return true;\n}\n\nfunction signupReset() {\n  signUpEmail.value = '';\n  signUpNickname.value = '';\n  signUpPassword.value = '';\n  signUpPassword2.value = '';\n}"]}